<UserControl x:Class="TamponiInventario.Wpf.Views.SwabsView"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
             mc:Ignorable="d">
    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto" />
            <RowDefinition Height="Auto" />
            <RowDefinition Height="*" />
        </Grid.RowDefinitions>

        <StackPanel Orientation="Horizontal" Grid.Row="0" VerticalAlignment="Center" Margin="0,0,0,12">
            <TextBlock Text="Tamponi" FontSize="20" FontWeight="Bold" />
            <StackPanel Orientation="Horizontal" Margin="24,0,0,0" VerticalAlignment="Center">
                <TextBox Width="260"
                         Margin="0,0,8,0"
                         VerticalContentAlignment="Center"
                         Text="{Binding SearchQuery, UpdateSourceTrigger=PropertyChanged}" />
                <Button Content="Cerca" Command="{Binding SearchCommand}" />
            </StackPanel>
            <StackPanel Orientation="Horizontal" Margin="24,0,0,0" VerticalAlignment="Center">
                <TextBlock Text="Soglie:" FontWeight="SemiBold" Margin="0,0,6,0" />
                <TextBlock Text="Avviso" />
                <TextBlock Text=": " />
                <TextBlock Text="{Binding GlobalWarnDays}" FontWeight="SemiBold" Margin="0,0,12,0" />
                <TextBlock Text="Allarme" />
                <TextBlock Text=": " />
                <TextBlock Text="{Binding GlobalAlarmDays}" FontWeight="SemiBold" />
            </StackPanel>
        </StackPanel>

        <StackPanel Grid.Row="1" Orientation="Horizontal" Margin="0,0,0,12" VerticalAlignment="Center">
            <Border Background="#FFF8E1" CornerRadius="4" Padding="6,2" Margin="0,0,8,0">
                <TextBlock Text="Avviso: giorni correnti o totali oltre soglia" />
            </Border>
            <Border Background="#FFCDD2" CornerRadius="4" Padding="6,2">
                <TextBlock Text="Allarme: giorni correnti o totali oltre soglia" />
            </Border>
        </StackPanel>

        <DataGrid Grid.Row="2"
                  ItemsSource="{Binding Swabs}"
                  AutoGenerateColumns="False"
                  CanUserAddRows="False"
                  IsReadOnly="True">
            <DataGrid.RowStyle>
                <Style TargetType="DataGridRow">
                    <Style.Triggers>
                        <DataTrigger Binding="{Binding Alarm}" Value="True">
                            <Setter Property="Background" Value="#FFCDD2" />
                        </DataTrigger>
                        <DataTrigger Binding="{Binding Warning}" Value="True">
                            <Setter Property="Background" Value="#FFF8E1" />
                        </DataTrigger>
                    </Style.Triggers>
                </Style>
            </DataGrid.RowStyle>
            <DataGrid.Columns>
                <DataGridTextColumn Header="SKU" Binding="{Binding Sku}" Width="140" />
                <DataGridTextColumn Header="Nome" Binding="{Binding Name}" Width="*" />
                <DataGridTemplateColumn Header="Stato" Width="100">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <TextBlock Text="RESO">
                                <TextBlock.Style>
                                    <Style TargetType="TextBlock">
                                        <Style.Triggers>
                                            <DataTrigger Binding="{Binding InStock}" Value="False">
                                                <Setter Property="Text" Value="PRESO" />
                                            </DataTrigger>
                                        </Style.Triggers>
                                    </Style>
                                </TextBlock.Style>
                            </TextBlock>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTextColumn Header="Macchina" Binding="{Binding MachineName}" Width="180" />
                <DataGridTextColumn Header="Giorni correnti" Binding="{Binding CurrentDays}" Width="120" />
                <DataGridTextColumn Header="Giorni totali" Binding="{Binding TotalDays}" Width="120" />
                <DataGridTemplateColumn Header="Etichetta" Width="140">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <Button Content="Stampa/Apri" Click="OpenLabel_Click" />
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
                <DataGridTemplateColumn Header="Segnalazioni" Width="140">
                    <DataGridTemplateColumn.CellTemplate>
                        <DataTemplate>
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Avviso" Margin="0,0,6,0" Visibility="Collapsed">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Warning}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                                <TextBlock Text="Allarme" Visibility="Collapsed">
                                    <TextBlock.Style>
                                        <Style TargetType="TextBlock">
                                            <Style.Triggers>
                                                <DataTrigger Binding="{Binding Alarm}" Value="True">
                                                    <Setter Property="Visibility" Value="Visible" />
                                                </DataTrigger>
                                            </Style.Triggers>
                                        </Style>
                                    </TextBlock.Style>
                                </TextBlock>
                            </StackPanel>
                        </DataTemplate>
                    </DataGridTemplateColumn.CellTemplate>
                </DataGridTemplateColumn>
            </DataGrid.Columns>
        </DataGrid>
    </Grid>
</UserControl>
