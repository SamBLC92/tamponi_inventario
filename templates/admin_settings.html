{% extends "base.html" %}
{% block content %}
  <div class="card">
    <h1>Impostazioni</h1>
    <p class="muted">Aggiorna le soglie globali per i tamponi in uso: avviso per giorni in scadenza e allarme per giorni superati.</p>

    <form method="post" style="margin-top:12px;" autocomplete="off">
      <input type="hidden" name="action" value="update_settings" />
      <label class="muted small" for="global-warn-days">Soglia globale avviso (giorni in scadenza)</label>
      <input
        id="global-warn-days"
        name="global_warn_days"
        type="number"
        min="1"
        step="1"
        value="{{ global_warn_days }}"
        required
      />
      <label class="muted small" for="global-alarm-days" style="margin-top:10px;">Soglia globale allarme (giorni superati)</label>
      <input
        id="global-alarm-days"
        name="global_alarm_days"
        type="number"
        min="1"
        step="1"
        value="{{ global_alarm_days }}"
        required
      />
      <h2 style="margin-top:20px;">Impostazioni barcode</h2>
      <p class="muted small">
        Personalizza le dimensioni e la resa del codice a barre sulle etichette.
        Le modifiche ai parametri barcode rigenerano automaticamente le etichette salvate.
      </p>
      <label class="muted small" for="barcode-module-width">Larghezza modulo (unità)</label>
      <input
        id="barcode-module-width"
        name="barcode_module_width"
        type="number"
        min="0.01"
        step="0.01"
        value="{{ barcode_settings.module_width }}"
        required
      />
      <label class="muted small" for="barcode-module-height" style="margin-top:10px;">Altezza modulo (unità)</label>
      <input
        id="barcode-module-height"
        name="barcode_module_height"
        type="number"
        min="0.01"
        step="0.01"
        value="{{ barcode_settings.module_height }}"
        required
      />
      <label class="muted small" for="barcode-quiet-zone" style="margin-top:10px;">Quiet zone</label>
      <input
        id="barcode-quiet-zone"
        name="barcode_quiet_zone"
        type="number"
        min="0.01"
        step="0.01"
        value="{{ barcode_settings.quiet_zone }}"
        required
      />
      <label class="muted small" for="barcode-font-size" style="margin-top:10px;">Dimensione font</label>
      <input
        id="barcode-font-size"
        name="barcode_font_size"
        type="number"
        min="1"
        step="1"
        value="{{ barcode_settings.font_size }}"
        required
      />
      <label class="muted small" for="barcode-text-distance" style="margin-top:10px;">Distanza testo</label>
      <input
        id="barcode-text-distance"
        name="barcode_text_distance"
        type="number"
        min="0.01"
        step="0.01"
        value="{{ barcode_settings.text_distance }}"
        required
      />
      <input type="hidden" name="barcode_write_text" value="0" />
      <div style="margin-top:12px; display:flex; gap:6px; align-items:center; justify-content: center;">
        <label for="barcode-write-text" style="margin:0;">
          Mostra testo sotto il barcode
        </label>
        <input
          id="barcode-write-text"
          name="barcode_write_text"
          type="checkbox"
          value="1"
          style="width: auto;"
          {% if barcode_settings.write_text %}checked{% endif %}
        />
      </div>
      <div style="margin-top:12px;">
        <button type="submit">Salva impostazioni</button>
      </div>
    </form>
    <hr style="margin:20px 0;" />
    <h2>Password admin</h2>
    <p class="muted small">Aggiorna la password dell'area amministrativa.</p>
    <form method="post" style="margin-top:12px;" autocomplete="off">
      <input type="hidden" name="action" value="update_password" />
      <label class="muted small" for="current-password">Password corrente</label>
      <input
        id="current-password"
        name="current_password"
        type="password"
        required
      />
      <label class="muted small" for="new-password" style="margin-top:10px;">Nuova password</label>
      <input
        id="new-password"
        name="new_password"
        type="password"
        minlength="8"
        required
      />
      <label class="muted small" for="confirm-password" style="margin-top:10px;">Conferma nuova password</label>
      <input
        id="confirm-password"
        name="confirm_password"
        type="password"
        minlength="8"
        required
      />
      <div style="margin-top:12px;">
        <button type="submit">Aggiorna password</button>
      </div>
    </form>
  </div>
{% endblock %}
